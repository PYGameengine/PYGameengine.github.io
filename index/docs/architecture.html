<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PYGameengine 文档 - 引擎架构</title>
    <link rel="stylesheet" href="../styles.css">
    <style>
        /* 文档特定样式 */
        .docs-sidebar {
            position: sticky;
            top: 100px;
            height: calc(100vh - 120px);
            overflow-y: auto;
        }
        
        .docs-sidebar::-webkit-scrollbar {
            width: 8px;
        }
        
        .docs-sidebar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .docs-sidebar::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        .docs-sidebar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .code-example {
            background-color: #f8fafc;
            border-left: 4px solid #4299e1;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
            overflow-x: auto;
        }
        
        .code-example pre {
            margin: 0;
            white-space: pre-wrap;
        }
        
        .note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .warning {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .tip {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .toc {
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        
        .toc h4 {
            margin-bottom: 10px;
            color: #2d3748;
        }
        
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        
        .toc li {
            margin-bottom: 8px;
        }
        
        .toc a {
            color: #4a5568;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .toc a:hover {
            color: #4299e1;
        }
        
        .architecture-diagram {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 30px auto;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .architecture-component {
            background-color: #ffffff;
            border-radius: 5px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
        }
        
        .architecture-component h4 {
            color: #2d3748;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .architecture-component p {
            color: #4a5568;
            margin-bottom: 15px;
        }
        
        .architecture-component ul {
            color: #4a5568;
            padding-left: 20px;
            margin-bottom: 15px;
        }
        
        .architecture-component li {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <header>
        <div class="container">
            <div class="logo">
                <h1>PYGameengine</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="../index.html">首页</a></li>
                    <li><a href="index.html">文档</a></li>
                    <li><a href="../download.html">下载</a></li>
                    <li><a href="../about.html">关于我们</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- 主内容区域 -->
    <section class="docs-page">
        <div class="container">
            <div class="docs-container">
                <!-- 侧边栏导航 -->
                <div class="docs-sidebar">
                    <h3>文档导航</h3>
                    <ul>
                        <li><a href="index.html">入门指南</a></li>
                        <li><a href="installation.html">安装指南</a></li>
                        <li><a href="architecture.html" class="active">引擎架构</a></li>
                        <li><a href="basic-concepts.html">基本概念</a></li>
                        <li><a href="tutorials/basic-game.html">教程：创建第一个游戏</a></li>
                        <li><a href="api-reference/core.html">API参考：核心模块</a></li>
                        <li><a href="api-reference/scene.html">API参考：场景管理</a></li>
                        <li><a href="api-reference/rendering.html">API参考：渲染系统</a></li>
                        <li><a href="api-reference/physics.html">API参考：物理系统</a></li>
                        <li><a href="api-reference/input.html">API参考：输入系统</a></li>
                        <li><a href="api-reference/audio.html">API参考：音频系统</a></li>
                        <li><a href="best-practices.html">最佳实践</a></li>
                        <li><a href="faq.html">常见问题</a></li>
                    </ul>
                </div>
                
                <!-- 文档内容 -->
                <div class="docs-content">
                    <h2>PYGameengine 引擎架构</h2>
                    
                    <div class="toc">
                        <h4>本文档包含：</h4>
                        <ul>
                            <li><a href="#overview">架构概述</a></li>
                            <li><a href="#core-modules">核心模块</a></li>
                            <li><a href="#system-modules">系统模块</a></li>
                            <li><a href="#rendering-system">渲染系统</a></li>
                            <li><a href="#physics-system">物理系统</a></li>
                            <li><a href="#input-system">输入系统</a></li>
                            <li><a href="#audio-system">音频系统</a></li>
                            <li><a href="#resource-management">资源管理</a></li>
                            <li><a href="#scene-management">场景管理</a></li>
                            <li><a href="#scripting-system">脚本系统</a></li>
                            <li><a href="#extensibility">可扩展性设计</a></li>
                        </ul>
                    </div>
                    
                    <h3 id="overview">架构概述</h3>
                    <p>PYGameengine 采用模块化、分层设计的架构，将游戏开发的各个方面划分为独立但相互协作的系统。这种设计使得引擎既易于使用，又具有良好的可扩展性。</p>
                    
                    <img src="https://via.placeholder.com/1000x600?text=PYGameengine+架构图" alt="PYGameengine 架构图" class="architecture-diagram">
                    
                    <div class="note">
                        <p><strong>注意：</strong>上图是简化的架构图，显示了主要模块和它们之间的关系。实际的引擎架构可能包含更多的子系统和依赖关系。</p>
                    </div>
                    
                    <h3 id="core-modules">核心模块</h3>
                    <p>核心模块是引擎的基础，提供了游戏循环、时间管理、事件系统等基础功能。</p>
                    
                    <div class="architecture-component">
                        <h4>引擎核心 (Engine Core)</h4>
                        <p>引擎核心是整个系统的中心，负责初始化各个子系统、管理游戏循环、协调各模块之间的通信。</p>
                        <ul>
                            <li>游戏主循环（更新、渲染、事件处理）</li>
                            <li>时间管理和帧率控制</li>
                            <li>系统初始化和关闭流程</li>
                            <li>模块生命周期管理</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>事件系统 (Event System)</h4>
                        <p>事件系统提供了松耦合的通信机制，允许不同模块之间通过事件进行交互。</p>
                        <ul>
                            <li>事件发布和订阅机制</li>
                            <li>事件过滤和优先级</li>
                            <li>自定义事件支持</li>
                            <li>输入事件转换</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>配置系统 (Configuration System)</h4>
                        <p>配置系统负责加载、管理和应用游戏和引擎的配置设置。</p>
                        <ul>
                            <li>配置文件加载和解析（JSON、YAML等格式）</li>
                            <li>配置项验证和类型转换</li>
                            <li>运行时配置修改</li>
                            <li>配置热重载</li>
                        </ul>
                    </div>
                    
                    <h3 id="system-modules">系统模块</h3>
                    <p>系统模块提供了游戏开发中的特定功能，如渲染、物理、音频等。</p>
                    
                    <h4 id="rendering-system">渲染系统</h4>
                    <p>渲染系统负责将游戏世界绘制到屏幕上，支持2D和3D渲染。</p>
                    
                    <div class="architecture-component">
                        <h4>渲染器 (Renderer)</h4>
                        <p>渲染器是渲染系统的核心，负责执行实际的绘制操作。</p>
                        <ul>
                            <li>图形API抽象层（支持OpenGL、DirectX、Vulkan等）</li>
                            <li>着色器管理和编译</li>
                            <li>批处理渲染优化</li>
                            <li>渲染状态管理</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>材质系统 (Material System)</h4>
                        <p>材质系统负责定义和管理物体的外观属性。</p>
                        <ul>
                            <li>材质资源加载和管理</li>
                            <li>着色器参数绑定</li>
                            <li>材质实例化和变体</li>
                            <li>PBR（基于物理的渲染）支持</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>光照系统 (Lighting System)</h4>
                        <p>光照系统负责计算场景中的光照效果。</p>
                        <ul>
                            <li>多种光源类型（点光源、方向光、聚光灯）</li>
                            <li>阴影映射技术</li>
                            <li>全局光照支持</li>
                            <li>光照衰减和颜色管理</li>
                        </ul>
                    </div>
                    
                    <h4 id="physics-system">物理系统</h4>
                    <p>物理系统模拟现实世界的物理规律，如碰撞、重力、摩擦力等。</p>
                    
                    <div class="architecture-component">
                        <h4>碰撞检测 (Collision Detection)</h4>
                        <p>碰撞检测系统负责检测物体之间的碰撞。</p>
                        <ul>
                            <li>多种碰撞体类型（球体、盒子、胶囊体、网格）</li>
                            <li>空间划分优化（八叉树、AABB树）</li>
                            <li>碰撞事件通知</li>
                            <li>射线投射支持</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>物理模拟 (Physics Simulation)</h4>
                        <p>物理模拟系统负责更新物体的位置和旋转，遵循物理规律。</p>
                        <ul>
                            <li>刚体动力学</li>
                            <li>重力和外力应用</li>
                            <li>约束系统（关节、弹簧等）</li>
                            <li>碰撞响应和反弹</li>
                        </ul>
                    </div>
                    
                    <h4 id="input-system">输入系统</h4>
                    <p>输入系统处理玩家的输入，包括键盘、鼠标、游戏手柄等。</p>
                    
                    <div class="architecture-component">
                        <h4>输入设备管理 (Input Device Management)</h4>
                        <p>负责检测、初始化和管理各种输入设备。</p>
                        <ul>
                            <li>键盘和鼠标输入</li>
                            <li>游戏手柄和控制器支持</li>
                            <li>触摸输入支持</li>
                            <li>设备状态监控</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>输入映射 (Input Mapping)</h4>
                        <p>输入映射系统允许将原始输入映射到游戏动作。</p>
                        <ul>
                            <li>可配置的输入映射</li>
                            <li>多键绑定支持</li>
                            <li>输入上下文管理</li>
                            <li>输入状态查询</li>
                        </ul>
                    </div>
                    
                    <h4 id="audio-system">音频系统</h4>
                    <p>音频系统负责游戏中的声音播放和管理。</p>
                    
                    <div class="architecture-component">
                        <h4>音频引擎 (Audio Engine)</h4>
                        <p>音频引擎是音频系统的核心，负责音频数据的处理和播放。</p>
                        <ul>
                            <li>多声道音频支持</li>
                            <li>3D空间音频</li>
                            <li>音频流和预加载</li>
                            <li>音频设备管理</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>声音管理 (Sound Management)</h4>
                        <p>负责声音资源的加载、播放控制和效果处理。</p>
                        <ul>
                            <li>音效和背景音乐播放</li>
                            <li>音量控制和淡入淡出</li>
                            <li>音频效果处理（混响、均衡器等）</li>
                            <li>音频资源缓存和释放</li>
                        </ul>
                    </div>
                    
                    <h3 id="resource-management">资源管理</h3>
                    <p>资源管理系统负责加载、缓存和释放游戏中的各种资源。</p>
                    
                    <div class="architecture-component">
                        <h4>资源加载器 (Resource Loader)</h4>
                        <p>资源加载器负责从文件系统或网络加载各种类型的资源。</p>
                        <ul>
                            <li>异步资源加载</li>
                            <li>资源依赖解析</li>
                            <li>资源格式转换</li>
                            <li>加载进度反馈</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>资源缓存 (Resource Cache)</h4>
                        <p>资源缓存系统负责管理已加载的资源，避免重复加载。</p>
                        <ul>
                            <li>LRU缓存策略</li>
                            <li>资源引用计数</li>
                            <li>内存使用监控</li>
                            <li>资源卸载策略</li>
                        </ul>
                    </div>
                    
                    <h3 id="scene-management">场景管理</h3>
                    <p>场景管理系统负责组织和管理游戏中的场景和物体。</p>
                    
                    <div class="architecture-component">
                        <h4>场景图 (Scene Graph)</h4>
                        <p>场景图是一种树状数据结构，用于组织场景中的物体。</p>
                        <ul>
                            <li>节点层次结构</li>
                            <li>变换继承</li>
                            <li>节点遍历和查询</li>
                            <li>场景序列化和反序列化</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>实体组件系统 (Entity Component System)</h4>
                        <p>实体组件系统提供了一种灵活的方式来定义和组合游戏物体的行为。</p>
                        <ul>
                            <li>实体创建和销毁</li>
                            <li>组件添加和移除</li>
                            <li>组件更新和通信</li>
                            <li>自定义组件支持</li>
                        </ul>
                    </div>
                    
                    <h3 id="scripting-system">脚本系统</h3>
                    <p>脚本系统允许开发者使用Python编写游戏逻辑，扩展引擎功能。</p>
                    
                    <div class="architecture-component">
                        <h4>Python集成 (Python Integration)</h4>
                        <p>负责Python解释器的初始化和管理，以及Python与C++之间的交互。</p>
                        <ul>
                            <li>Python脚本加载和执行</li>
                            <li>C++ API暴露给Python</li>
                            <li>Python回调注册</li>
                            <li>脚本热重载支持</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>脚本组件 (Script Components)</h4>
                        <p>允许将Python脚本作为组件附加到游戏物体上。</p>
                        <ul>
                            <li>脚本生命周期管理</li>
                            <li>脚本属性序列化</li>
                            <li>脚本调试支持</li>
                            <li>脚本事件处理</li>
                        </ul>
                    </div>
                    
                    <h3 id="extensibility">可扩展性设计</h3>
                    <p>PYGameengine 设计时考虑了良好的可扩展性，允许开发者自定义和扩展引擎功能。</p>
                    
                    <div class="architecture-component">
                        <h4>插件系统 (Plugin System)</h4>
                        <p>插件系统允许开发者创建和加载插件，扩展引擎功能。</p>
                        <ul>
                            <li>插件加载和卸载</li>
                            <li>插件依赖管理</li>
                            <li>插件API和生命周期</li>
                            <li>插件配置和状态</li>
                        </ul>
                    </div>
                    
                    <div class="architecture-component">
                        <h4>自定义渲染通道 (Custom Render Passes)</h4>
                        <p>允许开发者添加自定义渲染通道，实现特殊效果。</p>
                        <ul>
                            <li>渲染通道注册</li>
                            <li>渲染顺序控制</li>
                            <li>渲染目标管理</li>
                            <li>后处理效果支持</li>
                        </ul>
                    </div>
                    
                    <div class="tip">
                        <p><strong>提示：</strong>了解引擎架构有助于您更好地使用引擎功能，以及在需要时扩展引擎。如果您有特定的功能需求，可以参考相应模块的API文档来实现。</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <h4>PYGameengine</h4>
                    <p>轻量级游戏开发引擎，让游戏开发变得简单而强大。</p>
                </div>
                <div class="footer-links">
                    <h5>链接</h5>
                    <ul>
                        <li><a href="../index.html">首页</a></li>
                        <li><a href="index.html">文档</a></li>
                        <li><a href="../download.html">下载</a></li>
                        <li><a href="../about.html">关于我们</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h5>联系我们</h5>
                    <p>邮箱: contact@pygameengine.com</p>
                    <p>GitHub: github.com/pygameengine</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 PYGameengine. 保留所有权利。</p>
            </div>
        </div>
    </footer>

    <script src="../scripts.js"></script>
    <script>
        // 文档特定脚本
        document.addEventListener('DOMContentLoaded', function() {
            // 平滑滚动到锚点
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // 代码高亮（简化版）
            document.querySelectorAll('pre code').forEach(block => {
                // 在实际应用中，这里可以集成代码高亮库
                block.style.fontFamily = 'Courier New, monospace';
                block.style.backgroundColor = 'transparent';
            });
        });
    </script>
</body>
</html>